# 应用实例

本节所讲述的实例，用于回顾和练习本章讲述的一些知识点。读者可以先自己尝试编写程序，再对比书中给出的答案。





## 程序运行中改变控件标题

程序要求：在界面上放置一个数值型控件，既可用于输入一个长度值，也可用于输入一个重量值；再放置一个枚举类型单选按钮控件，用户可通过其输入选择数值控件的标题，显示是输入长度还是重量。

这个程序需要动态修改控件属性，需要使用控件的属性节点。由于运行时不能修改控件的标签，本程序需要显示的是 "数值" 控件的标题而不是标签（图
2.64、图 2.65）。

![](images/image150.png)

图 .64 程序运行时，改变控件的标题

![](images/image151.png)

图 .65 程序运行结果

## 禁止枚举控件中的某些项

程序要求：创建一个枚举型控件，但在程序运行过程中，需要暂时禁止它的某些选项。

这个过程实现起来相当简单，只要使用一个针对枚举类型的属性 "禁用项 \[\]" 就可以了。该属性的输入值是一个整数数组，数组的中元素的数值表示枚举控件中需要被禁用的选项（从 0 开始）。比如，需要禁用枚举控件中的第二条选项，则需要给 "禁用项 \[\]" 属性提供一个包含一个元素的整数数组，元素的值是 1（图
2.66、图 2.67）。

![](images/image152.png)

图 .66 禁用枚举型控件中的某些选项

![](images/image153.png)

图 .67 运行结果

## 在字符串中显示多种字体

程序要求：输出一个字符串 "LabVIEW 真好用！"，并突出强调 "好用" 两个字。

本程序关键是要熟悉字符串控件的属性，可以利用它的属性，选中控件中的一部分文字，修改其字体（图
2.66、图 2.67）。

![](images/image154.png)

图 .68 修改选中文字的字体

![](images/image155.png)

图 .69 程序运行结果

## 为列表框控件添加自定义的图标

在 LabVIEW
的列表框、树形等控件的每个条目的前端，都可以为其选择并显示出一个图标。选中控件的右键菜单 "显示项 -\> 符号"（
图 2.70），就可以把选取的图标显示出来。

![](images/image156.png)\
图 2.70 显示列表框的符号

控件中每个条目的图标的图案可以直接通过控件每个条目的右键菜单 "项符号" 来选择（图 2.71），也可通过在程序中设置控件的 "项符号" 属性来设置。控件自带的图标都比较简单，并且总共只有 40 个。（最后一个图标其实不是 "图标"，而是分割线，编程时可能会使用到。）

![](images/image157.png)\
图 2.71 选择条目的符号类型

这些控件自带的图案种类非常有限，但 LabVIEW 允许编程者自己定义列表空等控件条目的符号。以列表框控件为例，编程时，使用控件的 "自定义项符号 --> 设置为自定义符号" 方法，可以为控件添加自定义的图标。这个方法节点有两个输入:"索引" 表示图标的序号 (应该给新图标选择一个大于 40 的序号，以免覆盖掉控件自带的图标)；第二个输入参数 "图像" 则是自定义图标的图片（图 2.72）。

![](images/image158.png)\
图 2.72 设置条目自定义图标的程序

在这个例子中，图片
VI.png 是一张彩色的系统用来表示.vi 文件的图标。打开这个图片文件，得到它的图像数据，然后设置给列表框控件。其显示效果为图 2.73 中控件的最后一个条目。

![](images/image159.png)

图 2.73 使用自定义符号的显示效果



### 变体的应用

一般来说，LabVIEW 子 VI 的参数数据类型是固定的，一个子 VI 只能针对一种特定类型的数据进行操作。但是，有些算法也可以适用于多种数据类型。针对多种不同的数据类型，为这一算法编写多个不同的子 VI，这显然不是一个高效的办法。较为行之有效的办法是选用变体数据类型作为子 VI 的参数。这样，任何类型的数据在转变为变体后，都可调用这个子 VI 了。

类似的应用还有：不同类型的数据是不能够放在同一个数组中的。但遇到需要把不同元素放在同一数组中时，可以先把所有数据都转为变体类型，然后构成一个变体类型数组。

### 利用变体实现 Dictionary 容器（字典容器）功能

编程的时候经常会遇到这种情况：需要保存一些数据，这些数据的组织类似一张表格。表格由很多类型相同的条目组成，每个条目由一个唯一的标识符（比如 ID，名称等）和其它一些数据组成。程序能够保存这张表格；对表格中的条目进行修改；并根据标识符快速找到某个条目。

在 C++ 或 C# 中实现这样的功能非常简单，只要使用编程语言提供的 Map、Dictionary 等容器就可以了。这些容器已经具有了维护和查找这张表格的功能，用户只需使用它们的几个简单接口函数。遗憾的是，至今，LabVIEW 尚未提供类似的容器。当然，可以在程序中定义一个簇的数组来保存表单中的数据，然后再编写查询数据的代码。但这种方式编程复杂，查询效率太低。

有一种简便高效的实现类似的功能方法是利用 LabVIEW 自带的用来为变体数据类型设置属性的三个函数来保存和查询数据。这三个函数位于 "编程 -\> 簇、类与变体 -\> 变体" 函数选板，分别是 "获得变体属性"、"设置变体属性" 和 "删除变体属性" 这三个函数。从它们的名字就能知道它们原本的用途了。

![](images/image128.png)\
图 2.43 变体函数选板

变体数据的属性由一个名字和一个数据组成：每个属性的名字都必须是唯一的，数据则可以是任何的数据类型。这样，它恰好适合于前文提到的容器程序需求。可以把表单中的每一个条目看作是变体数据的一个属性：条目的标识就是属性的名称；条目的其它部分是属性的数据。创建和修改表单使用 "获得变体属性" 和 "删除变体属性" 函数；查询表单的内容使用 "设置变体属性" 函数就可以了。

比如图 2.44 所示的程序，其功能是根据学生姓名来查询成绩。在这个程序中，数据是一张表格，表格的第一列为 "姓名"，第二列是 "成绩"。当用户输入一个姓名，程序就查找出相应的成绩，返还给用户。

![](images/image129.png)\
图 2.44 使用变体属性实现 Dictionary 容器的程序框图

![](images/image130.png)\
图 2.45 使用变体属性实现字典容器的程序运行结果

变体的属性在 LabVIEW 中是以哈希表格式存储的。它的查询效率极高，所以特别适合用于需要查询大量数据的程序。

但它毕竟不是一个真正的容器，还有一些局限性，比如它的标识只能使用字符串。在本书第 13.3.5 节，将要更为详细地介绍数据容器。请读者参阅相关章节。