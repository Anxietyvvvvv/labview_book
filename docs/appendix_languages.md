# 其它一些编程语言

如果想要精通一门编程语言，可能只潜心钻研这一门编程语言还不够，花点时间学习一下其它的语言，反而可能会有一些意外收获。笔者也是在学习其它语言的过程中才意识到了 LabVIEW 的一些设计精妙之处，也开始反思了一些之前从没意识到的 LabVIEW 的缺陷。笔者在编写本书的时候，也是常常通过比较 LabVIEW 与 C/C++ 语言来解释问题。 

在这一章节里，LabVIEW 并不是主角，我们将要看到的是其它一些编程语言。当然，编程语言的种类实在是太多了，笔者只能挑出少数几种比较有特色的，进行简单介绍。

## 为什么有那么多的编程语言？

很难统计这世界上到底有多少种编程语言了。有时候，计算机系的学生们的某个作业就是去编写一些新的编程语言。即便只考虑那些有正式规范，已经被很多人使用了的编程语言，也至少会有上千种。我们为什么需要那么多的编程语言呢？能不能只维护一种或少数几种编程语言，使用去完成所有的工作？

这是几乎不可能的，因为改进一个现有的编程语言的成本非常之高。多数时候，创造一个新语言比改进已有的编程语言要经济的多。在各种不同的应用场合都会有编程的需求，比如在医疗、军工、航天等不同领域里。不同场合往往意味着不同的需求和侧重点，比如有些应用要求效率高，有些场合要求稳定性高，有些场合要求灵活性好等等。且不说这些需求之间可能就有矛盾，就假设我们遇到了一个新的需求，现有的编程语言都不能满足新的需求。如果我们去修改一个现有的编程语言，让它适应新的需求，这很有可能就会造成已经使用这门语言编写的程序都无法运行了。这样的后果是无法接受的，所以，安全的做法是不要改动已有的语言，而是创建一门新语言去满足新的需求。于是，新的编程语言总是层出不穷。所以我们看到，本来 C 语言已经很流行了，但是为了支持面向对象编程，人们又开发了 C++，Java 等。

当然，这并不是说编程语言一旦被设计好，就只能一成不变。实际上有生命力的编程语言都是要不断的进化自己的。只是这些改进不能够影响任何已有的功能。比如，C++ 在发布之后，又经历了数次大改进：支持模板、完善STL、加入lambda函数等等。现在 C++ 的编程思想与早年已经大相径庭了。笔者早年在使用 C++ 开发项目时，主要的精力都被消耗在查找内存泄漏和野指针上；而如今，C++ 也可以自动管理内存了，程序员也可以把主要经历放在业务逻辑上，而不是放在调试 bug 上。尽管 C++ 经历了如此大的变化，它依然还是同一个语言，因为它的每一次改进都是向前兼容的，绝对不会破坏已有的程序，早年编写的程序拿到现在的 C++ 编译器上一样可以编译成功。

有时候，编程语言的设计者也会发现一些无法容忍的设计失误，即使破坏兼容性，也要对其做修改。一个例子是 Python 从 2.0 升级到 3.0。这个版本升级只是为了修正少数几处设计缺陷，比如支持 unicode，改变整数除法行为等，大多数的 Python 代码还是不受影响的。可就是这样的小变动，Python 也花了了十来年的时间才彻底升级成功。

LabVIEW 年年出新版本，因为每个新版本只是修修 bug 或扩展一些功能，所以依然可以保证向前兼容，不会有太大升级阻力。但即便如此，因为 LabVIEW 不能保证向后兼容，不能用低版本的 LabVIEW 打开高版本 LabVIEW 保存的 VI，LabVIEW 的兼容性还是受到了不少批评的。LabVIEW 有一些广为诟病的问题，由于修改这些问题后无法保证兼容性，所以 NI 公司迟迟无法下决心做更正。比如支持 unicode，尽管支持 unicode 本身并不困难，可是一旦支持了 unicode，原本那些依赖非 unicode 编码的程序就都无法正常运行或显示了，所以 LabVIEW 也不敢轻易就变换编码。

尽管新编程语言层出不穷，但是绝大多数的新语言通常都会与某个已有的语言极其类似。在最流行的编程语言中，C++、C#、Java、PHP、JavaScript 都是类 C 语言。这些语言在设计时直接借鉴了 C 语言的语法、结构、关键字、运算符等。这样做的主要原因是为了降低新语言的入门门槛，比如，因为 Java 和 C++ 的大部分用法是相似的，如果一个程序员已经可以熟练使用 C++ 了，那么掌握 Java 会容易得多，他可以跳过两门语言中大量类似的特性，几种学习一下小部分的不同之处，就可以切换到使用新语言工作了。

## Lambda Calculus 编程语言

这里先问读者一个问题，一个最精简的编程语言可以简化到什么程度？

有些功能明显是为了方便开发者使用，但不是必须的，比如对面向对象编程的支持，这可以去掉。很多库函数也都是为了方便使用者的，也可以去掉。循环结构是必要的吗？似乎也可以去掉，程序员只要不怕麻烦，把循环拆开多谢几行代码似乎也可以。那么条件结构是必须的吗？没有 if else 的编程语言能实现所需的功能吗？运算符，比如加减乘除肯定是必须的吧，难道还能程序员自己用一个没有加减乘除的编程语言实现加减乘除的功能吗？

笔者考虑这个问题的时候，是在刚刚开始学习 C 语言的时候。有一次调试一段 C 语言代码。笔者一层一层的跟踪进入到被调用的子函数中去，想看看一个数据到底是怎么产生的。终于在遇到一个库函数的时候，调试器无法再跟踪进去了。C 语言程序通常会调用很多已经编译好的库函数，程序员只知道这些函数的接口，但看不到它们的实现代码。这是处于效率的考虑，但是给笔者的学习带来了阻碍。笔者忍不住想，是否有一种编程语言，可以不调用任何预先编译好的库，所有功能都以源代码的形式提供给程序员，方便学习呢？后来进而又想，是否很多的关键字，运算符也不是必须提前编译好的，编程语言必须提供的最小的功能集合是什么呢？

这些问题，一直到笔者学习到一门叫做 Lambda Calculus 的编程语言时才得到解答。Lambda Calculus 的发明人是 Alonzo Church。 Lambda Calculus 是一类非常精简的编程语言中的代表。这类语言中还包含 SKI，Iota 和 Jot 等，不过 Lambda Calculus 还是最经典的。Lambda Calculus 精简到了什么程度呢？只需要用几行文字就可以把它的全部语法描述清楚：

* Lambda Calculus 中用到的全部字符包括：小写英文字母，英文句号，小括号和一个希腊字母 lambda “λ”。
* 名字 name：由单个英文小写字母构成，格式为 <name>。 比如 x，y，a 等；
* 函数定义 function：由“λ”字符跟一个变量名，跟一个英文句号，再跟一个表达式，结构为 λ<name>.<expression>。比如 λx.x，这个函数写成数学的形式是 f(x) = x；
* 函数调用 application：由函数定义加另一段表达式构成，格式<function><expression>。比如： (λx.x)a，这表示，把 a 作为参数传递给前面那个函数，运算结果就是 a。
* name, function, application 又被统称为 expression （表达式）。
* 括号用于控制计算的优先级。有时代码里也会加入空格以方便阅读。

以上就是这个编程语言的全部语法了。笔者曾经给这个语言编写过一个编译器，其中最核心的部分只用了十来行代码就实现了，恐怕很难再有比这更简单的编程语言了。

可以直观的看出，这个编程语言的一些简单运算规则：

* λx.x 与 λy.y 是完全等价的，或者可以写成 λx.x ≡ λy.y
* (λx.x)a 可以简化成（推演运算得到） a，或者写成 (λx.x)a = a
* (λx.y)a = y
* (λx.(λy.x))a = λy.a

读者已经发现了，这个编程语言不但没有循环、条件等结构，甚至连数字、加减法等也没有。是的，编程语言必须提供的功能仅仅只是函数调用，只要有了函数调用，其它所有的运算都可以通过函数调用来实现。下面就介绍一下如何在 Lambda Calculus 中编写一些基本的程序功能：

* 实现多参数函数，这个方法有个专用名叫函数柯里化。比如实现函数f(x, y, z) = ((x, y), z) 可以使用如下的代码： λx.λy.λz.xyz
* 逻辑运算中的“真”被定义为：TRUE ≡ λx.λy.x。这里对于“真”的定义是：输入两个参数，返回第一个。推算一下 TRUE a b ≡ (λx.λy.x) a b = (λy.a) b = a
* 逻辑运算中的“假”被定义为：FALSE ≡ λx.λy.y。也就是输入两个参数，返回第二个。推算一下 FALSE a b ≡ (λx.λy.y) a b = (λy.y) b = b
* 判断语句 if，假设我们需要当变量 b 为 真时，返回 t；当 b 为假时返回 f。那么可以定义 IF b t f ≡ λb.b t f 。 推算一下 IF TRUE t f ≡ ((λb.b) (λx.λy.x)) t f = (λx.λy.x) t f = t ; IF FALSE b t f ≡ (λb.b t f) (λx.λy.y) = (λx.λy.y) t f = f
* 有了以上的基础，逻辑运算的定义就简单多了，比如：AND a b ≡ IF a b FALSE； OR a b ≡ IF a TRUE b； NOT a ≡ IF a FALSE TRUE
* 定义数字：
   * 0 ≡ λf.λx.x 可发现 0 ≡ FALSE
   * 1 ≡ λf.λx.f x
   * 2 ≡ λf.λx.f (f x)
   * 3 ≡ λf.λx.f (f (f x) x)
   * ……
* 为了方便数字运算还要先定义一个辅助的“后继函数”：S = λn.λf.λx.f((n f) x) 。调用这个函数会得到输出参数的下一个数，比如 S4 = 5。试验一下：S 0 ≡ (λn.λf.λx.f((n f) x)) (λf.λx.x) = λf.λx.f(λx.x f) x) = λf.λx.f x ≡ 1
* 加法就可以定义为： ADD ≡ λa λb.(a S) b 。 拭一下：ADD 2 3 = (λa λb.(a S) b) 2 3 = 2 S 3 ≡ (λf.λx.f (f x)) S 3 = λx. S (S x) 3 = S (S 3) = S 4 = 5.

以上是 Lambda Calculus 一些最基本的功能，作为一个图灵完全的语言，它能做的远不止这些，其它编程语言能做的，它也都可以做。但是使用它，所有的功能都需要程序员自己实现，效率太过低下。尽管 Lambda Calculus 不能成为一门实用的编程语言，但作为最经典的教学语言，对后来编程语言的发展产生了深远的影响。函数式编程就是受此启发而来的。如今，Lambda 函数更是成了主流编程语言的标配。